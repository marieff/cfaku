dns:
  enable: true
  ipv6: true
  enhanced-mode: redir-host
  listen: 0.0.0.0:7874
  default-nameserver:
  - 8.8.8.8
  - 8.8.4.4
  - 1.1.1.1
  - 1.0.0.1
  - 9.9.9.9
  nameserver:
  - 1.1.1.1
  - 8.8.8.8
  - 9.9.9.9
  fallback:
  - 1.1.1.1
  - 8.8.8.8
  - 9.9.9.9
redir-port: 9797
tproxy-port: 9898
port: 7890
socks-port: 7891
mixed-port: 7893
mode: rule
log-level: silent
allow-lan: true
external-controller: 0.0.0.0:9090
bind-address: "*"
external-ui: "/data/adb/box/clash/dashboard"
ipv6: false
tun:
  enable: false
  stack: system
  auto-route: false
  auto-detect-interface: false
  dns-hijack:
  - tcp://8.8.8.8:53
  - tcp://8.8.4.4:53
profile:
  store-selected: true
  store-fake-ip: true
tcp-concurrent: true

proxy-providers:
  VVIP-IPTUNNELS-FREE:
    type: http
    url: "https://raw.githubusercontent.com/marieff/cfaku/main/proxy/vvip-free.yaml"
    interval: 3600
    path: "./proxy_provider/vvip-free.yaml"
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 180
  VVIP-IPTUNNELS-VIP:
    type: http
    url: "https://raw.githubusercontent.com/marieff/cfaku/main/proxy/proxy-hiddify.yaml"
    interval: 3600
    path: "./proxy_provider/vvip-vip.yaml"
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 180

rule-providers:
  rule_whatsapp:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/marieff/cfaku/main/rules/rule_whatsapp.yaml
    path: "./rule_provider/rule_whatsapp.yaml"
    interval: 86400
  #rule_basicads:
    #type: http
    #behavior: classical
    #url: https://raw.githubusercontent.com/marieff/cfaku/main/rules/rule_basicads.yaml
    #path: "./rule_provider/rule_basicads.yaml"
    #interval: 86400
  rule_portgames:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/marieff/cfaku/main/rules/rule_portgames.yaml
    path: "./rule_provider/rule_portgames.yaml"
    interval: 86400
  rule_bank-id:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/marieff/cfaku/main/rules/rule_bank-id.yaml
    path: "./rule_provider/rule_bank-id.yaml"
    interval: 86400
  rule_indo:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/marieff/cfaku/main/rules/rule_indo.yaml
    path: "./rule_provider/rule_indo.yaml"
    interval: 86400

proxy-groups:
- name: Global
  type: select
  disable-udp: false
  proxies:
  - BEST-PING
  - LOAD-BALANCE
  - FALLBACK
  - PROXY-CHAIN
  - SELECT
- name: SELECT
  type: select
  disable-udp: false
  use:
  - VVIP-IPTUNNELS-FREE
  - VVIP-IPTUNNELS-VIP
  url: http://www.gstatic.com/generate_204
  interval: 300
#- name: AdBlock
  #type: select
  #disable-udp: false
  #proxies:
  #- REJECT
  #- Global
- name: Select_VIP
  type: fallback
  lazy: true
  disable-udp: false
  use:
  - VVIP-IPTUNNELS-VIP
  url: http://www.gstatic.com/generate_204
  interval: 600
- name: LOAD-BALANCE
  type: load-balance
  strategy: round-robin
  lazy: true
  disable-udp: false
  use:
  - VVIP-IPTUNNELS-FREE
  - VVIP-IPTUNNELS-VIP
  url: http://www.gstatic.com/generate_204
  interval: 300
- name: FALLBACK
  type: fallback
  lazy: true
  disable-udp: false
  use:
  - VVIP-IPTUNNELS-FREE
  - VVIP-IPTUNNELS-VIP
  url: http://www.gstatic.com/generate_204
  interval: 300
- name: BEST-PING 
  type: url-test
  tolerance: 50
  lazy: true
  disable-udp: false
  use:
  - VVIP-IPTUNNELS-FREE
  - VVIP-IPTUNNELS-VIP
  url: http://www.gstatic.com/generate_204
  interval: 300
- name: PROXY-CHAIN
  type: relay
  disable-udp: false
  proxies:
  - BEST-PING
  - LOAD-BALANCE
  - FALLBACK

rules:
- DST-PORT,7895,REJECT
- DST-PORT,7892,REJECT
- DST-PORT,7895,REJECT
- DST-PORT,7892,REJECT
- IP-CIDR,198.18.0.1/16,REJECT,no-resolve

# # fix dnsleak
- IP-CIDR,127.0.0.1/32,REJECT,no-resolve
- IP-CIDR,198.18.0.1/16,REJECT,no-resolve
- IP-CIDR,28.0.0.1/8,REJECT,no-resolve
- IP-CIDR6,::1/128,REJECT,no-resolve
   
## rules inner, recommended untuk non kuota reguler
- AND,((PROCESS-NAME,clash),(NOT,((IN-TYPE,inner)))),REJECT
- IN-TYPE,inner,Global

#- RULE-SET,rule_basicads,AdBlock
- RULE-SET,rule_whatsapp,Select_VIP
- RULE-SET,rule_portgames,Select_VIP
- MATCH,Global
